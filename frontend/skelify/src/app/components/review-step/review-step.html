<div class="review-container">
  @if (wizardState.isLoading()) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">Generating your project, please wait...</p>
    </div>
  } @else if (wizardState.isGenerated()) {
    <div class="generated-container">
      <div class="generated-icon">
        <svg class="generated-svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
      </div>
      <h2 class="generated-title">Project Generated!</h2>
      <p class="generated-text">Congratulations! Your project is ready for download.</p>
      <button class="download-button" (click)="downloadProject()">
        Download Project
      </button>
    </div>
  } @else {
    <h2 class="review-title">Review Your Configuration</h2>
    <div class="review-grid">

      <!-- Project Information Card -->
      <div class="review-card">
        <h3 class="card-title project-info-title">Project Information</h3>
        <div class="card-content">
          <p class="info-row"><strong class="info-label">Project Name: </strong> <span class="info-value">{{ wizardState.projectInfo().projectName }}</span></p>
          <p class="info-row"><strong class="info-label">Description: </strong> <span class="info-value">{{ wizardState.projectInfo().projectDescription }}</span></p>
          <p class="info-row"><strong class="info-label">Organization: </strong> <span class="info-value">{{ wizardState.projectInfo().organization }}</span></p>
          <p class="info-row"><strong class="info-label">Package Name: </strong> <span class="info-value">{{ wizardState.projectInfo().packageName }}</span></p>
        </div>
      </div>

      <!-- Technology Stack Card -->
      <div class="review-card">
        <h3 class="card-title tech-stack-title">Technology Stack</h3>
        <div class="card-content">
          <p class="info-row"><strong class="info-label">Backend: </strong> <span class="info-value">{{ wizardState.techStack().backend }}</span></p>
          <p class="info-row"><strong class="info-label">Frontend: </strong> <span class="info-value">{{ wizardState.techStack().frontend }}</span></p>
          <p class="info-row"><strong class="info-label">Mobile: </strong> <span class="info-value">{{ wizardState.techStack().mobile }}</span></p>
          <p class="info-row"><strong class="info-label">Database: </strong> <span class="info-value">{{ wizardState.techStack().database }}</span></p>
          <p class="info-row"><strong class="info-label">Security: </strong> <span class="info-value">{{ wizardState.techStack().security }}</span></p>
        </div>
      </div>

      <!-- Infrastructure Card -->
      <div class="review-card infrastructure-card">
        <h3 class="card-title infrastructure-title">Infrastructure</h3>
        <div class="card-content">
          <p class="info-row">
            <strong class="info-label">Bitbucket: </strong> <span class="info-value">{{ wizardState.infrastructure().bitbucket.flow }}</span>
          </p>
          <p class="info-row">
            <strong class="info-label">Deployment: </strong> <span class="info-value">{{ wizardState.infrastructure().deployment.type }}</span>
          </p>

          <p class="info-row-flex">
              <strong class="info-label">Xray: </strong>
              <span class="info-value flex-1">
                {{ wizardState.infrastructure().xray.vulnerabilityScan ? 'Enabled' : 'Disabled' }}
              </span>
              @if (wizardState.infrastructure().xray.vulnerabilityScan ){
                <svg
                  class="status-icon"
                  fill="none" stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                  [hidden]="!wizardState.infrastructure().xray.vulnerabilityScan">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                </svg>
              }
            </p>

            <p class="info-row-flex">
              <strong class="info-label">SonarQube: </strong>
              <span class="info-value flex-1">
                {{ wizardState.infrastructure().sonarQube.enabled ? 'Enabled' : 'Disabled' }}
              </span>
              @if (wizardState.infrastructure().sonarQube.enabled ){
                <svg
                  class="status-icon"
                  fill="none" stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                  [hidden]="!wizardState.infrastructure().sonarQube.enabled">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                </svg>
              }
            </p>

        </div>
      </div>

    </div>
  }
</div>
<app-download-modal [isOpen]="isModalOpen()" (closeModal)="closeModal()" />
